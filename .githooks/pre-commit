#!/usr/bin/env sh

set -eu

if ! command -v gofmt >/dev/null 2>&1; then
  echo "pre-commit: gofmt is required but not found in PATH" >&2
  exit 1
fi

echo "pre-commit: running gofmt -w ."
gofmt -w .

echo "pre-commit: staging gofmt updates"
git add -A

if command -v golangci-lint >/dev/null 2>&1; then
  echo "pre-commit: running golangci-lint run"
  golangci-lint run
else
  echo "pre-commit: golangci-lint not found; skipping lint (install: https://golangci-lint.run/welcome/install/)" >&2
fi

echo "pre-commit: checks passed"
